<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>내 영상 관리 - CopyTube</title>

  <link rel="stylesheet" href="css/style.css"/>

  <!-- 목록1.3 레이아웃 (v1.3.2) + 로그인 유지 + 모달 스크롤 픽스 -->
  <style>
    /* ----- 모달 스크롤/배경 잠금 ----- */
    .modal-backdrop{
      position:fixed; inset:0;
      background:rgba(0,0,0,.55);
      display:none; align-items:center; justify-content:center;
      z-index:2000;
      overflow:hidden;               /* 배경 스크롤 차단 */
    }
    .modal-backdrop.show{ display:flex; }
    .modal{
      width:min(760px, 92vw);
      background:#0f0f0f; border:1px solid var(--border); border-radius:12px; padding:12px;
      max-height:92dvh; margin:10px;
      display:flex; flex-direction:column;
      overflow:hidden;               /* 내부(#editCats)만 스크롤 */
    }
    #editCats{
      flex:1; min-height:0; overflow:auto;
      -webkit-overflow-scrolling:touch; overscroll-behavior:contain;
      padding-block:6px 10px;
    }
    html.modal-open, body.modal-open{ overflow:hidden; }

    /* ----- 목록1.3 카드 레이아웃 (여백 1/2, 버튼 가로) ----- */
    .list{ display:flex; flex-direction:column; gap:7px; }
    .row{
      border:1px solid var(--border); background:#101010; border-radius:12px;
      display:grid;
      grid-template-columns: 28px 1fr 140px;   /* 체크박스 | 본문 | 썸네일 */
      grid-template-rows: auto auto auto auto; /* 제목 / URL / 카테고리 / 하단 */
      grid-template-areas:
        "sel title title"
        "sel url   ."
        "sel cats  ."
        "sel thumb actions";                   /* 버튼은 썸네일 오른쪽(하단 행) */
      gap:5px;
      padding:6px;
      align-items:start;
    }
    .sel{ grid-area:sel; display:flex; align-items:flex-start; padding-top:2px; }
    .sel .selbox{ width:18px; height:18px; }

    .title{ grid-area:title; font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .url  { grid-area:url;   font-size:13px; color:#9aa0a6; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .cats { grid-area:cats;  display:flex; flex-wrap:wrap; gap:3px; }
    .chip { font-size:12px; padding:1px 4px; border:1px solid #2a2a2a; border-radius:999px; color:#ddd; }

    .thumb{
      grid-area:thumb;
      width:140px; height:79px; border-radius:8px; overflow:hidden; background:#000;
      display:flex; align-items:center; justify-content:center;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; }

    .actions{
      grid-area:actions;
      display:flex; flex-direction:row; gap:6px;             /* 가로 배치 */
      align-items:center; justify-content:flex-end; flex-wrap:wrap;
    }
    .btn{ padding:5px 6px; border-radius:10px; border:1px solid #2a2a2a; background:#151515; color:#fff; cursor:pointer; }
    .btn:hover{ background:#1a1a1a; }
    .btn-danger{ background:#dc2626; border:0; }
    .btn-cat{ background:#6495ED; border:0; font-weight:700; } /* 카테고리 버튼 색 */
    /* 두 버튼만 좌우 패딩 10px */
    .row .actions .btn-cat, .row .actions .btn-danger{ padding-left:10px; padding-right:10px; }


    .msg{ margin:8px 0; font-size:13px; color:#ccc; min-height:1.2em; }

    /* 모바일: 버튼을 제목 옆이 아니라 하단에서만, 썸네일 오른쪽에 */
    @media (max-width:520px){
      .row{
        grid-template-columns: 28px 1fr auto; /* 썸네일 옆 버튼 열 */
        grid-template-areas:
          "sel title ."
          "sel url   ."
          "sel cats  ."
          "sel thumb actions";                /* 하단에만 actions */
      }
      .thumb{ width:120px; height:68px; }
      .actions{ justify-content:flex-end; }
    }
  </style>
</head>
<body>
  <header id="topbar">
    <div class="brand">
      <a href="./" aria-label="CopyTube 홈으로"><img class="brand-logo" src="image/copytube_logo_side.png" alt="CopyTube"/></a>
    </div>
    <div class="right" style="position:relative;">
      <a id="signupLink" class="link" href="signup.html">Sign up</a>
      <a id="signinLink" class="link" href="signin.html">Sign in</a>
      <span id="welcome" class="welcome"></span>
      <button id="menuBtn" class="icon" aria-label="menu">三</button>
      <div id="dropdownMenu" class="dropdown hidden" role="menu" aria-hidden="true">
        <button id="btnAbout" type="button">CopyTube는…</button>
        <button id="btnGoUpload" class="menu-strong" type="button">추천영상등록</button>
        <button id="btnSignOut" type="button">Sign out</button>
      </div>
    </div>
  </header>

  <main>
    <h2>내 영상 관리</h2>

    <div class="toolbar" style="display:grid; grid-template-columns:1fr auto auto; gap:8px; align-items:center;">
      <div class="search" style="display:flex; gap:8px; align-items:center; border:1px solid var(--border); background:#0f0f0f; border-radius:10px; padding:8px 10px;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35M16 10.5A5.5 5.5 0 1 1 5 10.5a5.5 5.5 0 0 1 11 0Z" stroke="#9aa0a6" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="q" type="search" placeholder="제목/URL 검색" style="flex:1; min-width:120px; border:0; outline:0; background:transparent; color:#fff;"/>
      </div>
      <button id="btnSearch" class="btn">검색</button>
      <button id="btnDeleteSel" class="btn btn-danger">선택 삭제</button>
    </div>

    <div id="msg" class="msg"></div>

    <div id="list" class="list"></div>
    <div id="more" class="loadmore" style="text-align:center; margin:12px 0; display:none;">
      <button id="btnMore" class="btn">더 보기</button>
    </div>
  </main>

  <!-- 카테고리 편집 모달 -->
  <div id="editBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="editTitle">
      <h3 id="editTitle" style="margin:0 0 8px;">카테고리 수정</h3>
      <div id="editCats"><!-- JS 렌더 --></div>
      <div class="row-right" style="display:flex; gap:8px; justify-content:flex-end; margin-top:10px;">
        <button id="btnEditCancel" class="btn">취소</button>
        <button id="btnEditSave" class="btn" style="background:#4ea1ff; border:0; font-weight:800;">저장</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/firebase-init.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module" src="js/categories.js"></script>
  <script type="module" src="js/manage-uploads.js?v=1.3.2"></script>
</body>
</html>
