<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>영상 목록 - KidsAni</title>

  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src 'self' https://www.googleapis.com https://firestore.googleapis.com https://securetoken.googleapis.com https://identitytoolkit.googleapis.com https://firebaseinstallations.googleapis.com https://www.gstatic.com https://www.youtube.com;
    img-src 'self' data: https://i.ytimg.com;
    frame-src https://www.youtube.com;
    script-src 'self' https://www.gstatic.com 'unsafe-inline';
    style-src 'self' 'unsafe-inline';
    object-src 'none';
    base-uri 'self';
  ">

  <link rel="stylesheet" href="css/style.css"/>

  <style>
    body { padding-top: 52px; } /* 상단바 높이만큼 패딩 */
    main { max-width: 1100px; margin: 0 auto; padding: 0 16px 40px; }

    /* --- 카테고리 필터 (style.css의 .group, .child-grid 활용) --- */
    #category-filters .group { margin-top: 0; }
    #category-filters .group legend { margin-bottom: 0; }
    #category-filters .child-grid { margin-top: 0; }
    
    /* --- 시리즈 헤더 --- */
    .series-header {
        padding: 16px;
        background: var(--bg-3);
        border: 1px solid var(--border);
        border-radius: 12px;
        margin: 12px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
    }
    .series-header h3 { margin: 0; font-size: 1.4em; }
    .series-header p { margin: 0; color: var(--muted); }
    .series-sort-toggle {
        padding: 8px 14px;
        border-radius: 10px;
        border: 1px solid #2a2a2a;
        background: #151515;
        color: #fff;
        cursor: pointer;
    }

    /* --- 카드 리스트 (style.css 규칙을 따름) --- */
    .cards { display: flex; flex-direction: column; gap: 10px; margin-top: 10px; }
    
    .msg, .loader { text-align: center; padding: 20px; color: var(--muted); }
    #more { text-align: center; margin: 20px 0; }
    #btnMore { padding: 10px 24px; border-radius: 20px; border: 1px solid #3a3a3a; background: #252525; color: #fff; cursor: pointer; font-size: 15px; }
    #btnMore:hover { background: #3a3a3a; }
  </style>
</head>
<body>
  <header id="topbar">
    <div class="brand">
      <a href="./" aria-label="홈으로"><img class="brand-logo" src="image/copytube_logo_side.png" alt="KidsAni"/></a>
    </div>
    <div class="right">
      <a id="signupLink" class="link" href="signup.html">Sign up</a>
      <a id="signinLink" class="link" href="signin.html">Sign in</a>
      <span id="welcome" class="welcome"></span>
      <button id="menuBtn" class="icon" aria-label="menu">☰</button>
      <div id="dropdownMenu" class="dropdown hidden">
        <button id="btnSignOut" type="button">Sign out</button>
        <button id="btnGoUpload" class="menu-strong" type="button">영상 등록</button>
        <button id="btnManageUploads" type="button">업로드 관리</button>
      </div>
    </div>
  </header>

  <main>
    <div class="toolbar">
      <div id="category-filters"></div>

      <div class="s_bar">
        <div class="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#9aa0a6" stroke-width="2" stroke-linecap="round"><path d="M21 21l-4.35-4.35M16 10.5A5.5 5.5 0 1 1 5 10.5a5.5 5.5 0 0 1 11 0Z"/></svg>
          <input id="query" type="search" placeholder="제목으로 검색..."/>
        </div>
        <select id="sort" class="btn">
            <option value="latest">최신순</option>
            <option value="oldest">오래된순</option>
            <option value="title_asc">가나다순</option>
            <option value="series_latest">시리즈 최신</option>
        </select>
      </div>
    </div>

    <div id="series-header" class="series-header" style="display:none;"></div>

    <div id="msg" class="msg"></div>

    <ul id="cards" class="cards" style="list-style:none; padding:0;" aria-live="polite"></ul>

    <div id="more" style="display:none;">
      <button id="btnMore" class="btn">더 보기</button>
    </div>
  </main>

  <script type="module" src="js/firebase-init.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script type="module" src="js/categories.js"></script>
  <script type="module" src="js/swipe-index.js"></script>
  <script type="module" src="js/list.js"></script>
</body>
</html>
