<!-- watch.html (v0.1.1-kidsani) -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>영상 보기</title>

  <!-- CSP: 기존 정책 유지 + watch 전용으로 youtube.com 스크립트 허용 추가(iframe API) -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    connect-src 'self' https://www.googleapis.com https://firestore.googleapis.com https://securetoken.googleapis.com https://identitytoolkit.googleapis.com https://firebaseinstallations.googleapis.com https://www.gstatic.com https://www.youtube.com;
    img-src 'self' data: https://i.ytimg.com;
    frame-src https://www.youtube.com;
    script-src 'self' https://www.gstatic.com https://www.youtube.com 'unsafe-inline';
    style-src 'self' 'unsafe-inline';
    object-src 'none';
    base-uri 'self';
  ">

  <link rel="stylesheet" href="css/style.css"/>
  <style>
    /* 화면 톤/간격은 기존 스타일을 따르고, 필요한 최소 레이아웃만 정의 */
    body{ padding-top:48px; }
    main{ max-width:1100px; margin:0 auto; padding:0 12px 28px; }
    .player-wrap{ position:relative; width:100%; aspect-ratio:16/9; background:#000; border-radius:12px; overflow:hidden; }
    .player-wrap iframe{ position:absolute; inset:0; width:100%; height:100%; }
    .controls{ display:flex; gap:8px; justify-content:space-between; align-items:center; margin:8px 0 0; }
    .btn{ padding:8px 10px; border-radius:10px; border:1px solid #2a2a2a; background:#151515; color:#fff; cursor:pointer; }
    .btn:hover{ background:#1a1a1a; }
    .title{ margin:10px 0 6px; font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .chips{ display:flex; gap:4px; flex-wrap:wrap; }
    .chip{ font-size:12px; padding:1px 6px; border:1px solid #2a2a2a; border-radius:999px; color:#ddd; }
    .right-ctrls{ display:flex; gap:8px; align-items:center; }
    .mute-btn{ padding:6px 10px; border-radius:999px; border:1px solid #2a2a2a; background:#101010; color:#fff; cursor:pointer; }
    .meta{ font-size:12px; color:#9aa0a6; margin-top:4px; }
  </style>
</head>
<body>
  <!-- 상단바 (기존 톤 유지) -->
  <header id="topbar">
    <div class="brand">
      <a href="./" aria-label="홈으로"><img class="brand-logo" src="image/kidsani_r_side.png" alt="KidsAni"/></a>
    </div>
    <div class="right" style="position:relative;">
      <a id="signupLink" class="link" href="signup.html">Sign up</a>
      <a id="signinLink" class="link" href="signin.html">Sign in</a>
      <span id="welcome" class="welcome"></span>
      <button id="menuBtn" class="icon" aria-label="menu">三</button>
      <div id="dropdownMenu" class="dropdown hidden" role="menu" aria-hidden="true">
        <button id="btnAbout" type="button">KidsAni는…</button>
        <button id="btnSignOut" type="button">Sign out</button>
        <button id="btnList" type="button">영상목록</button>
        <button id="btnGoUpload" class="menu-strong" type="button">추천영상등록</button>
      </div>
    </div>
  </header>

  <main>
    <div class="player-wrap" id="playerWrap">
      <div id="player"></div>
    </div>

    <div class="controls">
      <button id="btnPrev" class="btn" type="button">◀ 이전</button>
      <div class="right-ctrls">
        <button id="btnMute" class="mute-btn" type="button" aria-pressed="true">🔇 음소거</button>
        <button id="btnNext" class="btn" type="button">다음 ▶</button>
      </div>
    </div>

    <div class="title" id="title">(제목 없음)</div>
    <div class="chips" id="chips"></div>
    <div class="meta" id="meta"></div>
  </main>

  <!-- 공통 모듈 -->
  <script type="module" src="js/firebase-init.js"></script>
  <script type="module" src="js/auth.js"></script>

  <!-- YouTube Iframe API (이 페이지에서만 사용) -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <!-- 페이지 스크립트 -->
  <script type="module" src="js/watch.js?v=0.1.1-kidsani"></script>
</body>
</html>
<!-- end of watch.html (v0.1.1-kidsani) -->
